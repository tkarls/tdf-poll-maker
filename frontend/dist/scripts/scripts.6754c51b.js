"use strict";angular.module("tdfPollMakerApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngMaterial","ngclipboard","ngStorage"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).otherwise({redirectTo:"/"})}]).config(["$locationProvider",function(a){a.html5Mode(!0).hashPrefix("*")}]),angular.module("tdfPollMakerApp").controller("MainCtrl",["$http","$scope","$localStorage","$timeout","$log",function(a,b,c,d,e){function f(){return a.post("/api/parse/forum-page").then(function(a){b.months=a.data})["catch"](function(a){e.error(a)}).then(function(){})}b.storage=c,b.loadCandidates=function(f){return b.loadingCandidates=!0,a.post("/api/parse/entry-thread",{threadUri:f}).then(function(a){b.candidates=a.data.map(function(a){var b=f+a.postAuthor+a.postBody.images[0];return a.storageKey=b,c[b]=c[b]||{isIncluded:!0},a})})["catch"](function(a){e.error(a)}).then(function(){b.loadingCandidates=!1,d(function(){},1e3)})};var g=function(a){return a?a.trim().replace(/^\"|\"$/g,""):"unknown"};b.getBbCode=function(a){var b=c[a.storageKey];return"[center][list][size=140][color=#EFF7FB][*][*][*][*]*[/color][b][color=#FF00FF]"+g(b.dollName)+'[/color] [color=#000000]in[/color] [color=#0040FF]"'+g(b.caption)+'" [/color][/b][color=#EFF7FB][*]*[/color][i][color=#000000]by '+a.postAuthor+"[/color][/i][/size][color=#EFF7FB][*]*[/color][color=#EFF7FB][*][img600]"+a.postBody.images[0]+"[/img600][/color][/list][/center]"},b.getAllBbCode=function(){var a="";return(b.candidates||[]).forEach(function(d){c[d.storageKey].isIncluded&&(a+=b.getBbCode(d)+"\n")}),a.trim()},f()}]).filter("highlight",["$sce","$localStorage",function(a,b){return function(c,d){var e=new RegExp(/((?:[A-Z][a-zA-Z_\-0-9]+ )?(?:[A-Z][a-zA-Z_\-0-9]+ and )?[A-Z][a-zA-Z_\-0-9]+) (?:i|I)n.{0,4}(?:"|'')([a-zA-Z0-9!?.,' -_]+)(?:"|'')/),f=c.match(e);return f&&(b[d.storageKey].dollName||(b[d.storageKey].dollName=f[1]),b[d.storageKey].caption||(b[d.storageKey].caption=f[2])),c=c.replace(e,'<span class="highlighted">$1</span> in "<span class="highlighted">$2</span>"'),a.trustAsHtml(c)}}]),angular.module("tdfPollMakerApp").run(["$templateCache",function(a){a.put("views/main.html",'<div layout="column" ng-if="months"> <md-input-container> <label>Select your contest thread</label> <md-select ng-model="storage.tdfUri" aria-label="select the contest thread" required> <md-optgroup ng-repeat="month in months" label="{{month.name}}"> <md-option ng-repeat="thread in month.threads" ng-value="thread.uri">{{thread.name}}</md-option> </md-optgroup> </md-select> </md-input-container> <div> <md-button class="md-primary md-raised" ng-click="loadCandidates(storage.tdfUri)" ng-disabled="loadingCandidates">Get candidate entries</md-button> </div> </div> <div ng-if="!months"> <p>Loading contest threads...</p> </div> <!-- <div layout="column">\r\n    <md-input-container>\r\n        <label>Enter the URL to the contest thread</label>\r\n        <input type="text" ng-model="storage.tdfUri">\r\n    </md-input-container>\r\n    <div>\r\n        <md-button class="md-primary md-raised" ng-click="loadCandidates(storage.tdfUri)">Get candidate entries</md-button>\r\n    </div>\r\n</div> --> <div ng-if="loadingCandidates"> <p>Loading thread data...</p> </div> <div class="candidate-list" ng-if="candidates"> <table> <tr> <th>Entry?</th> <th>Contestant</th> <th>Text</th> <th>Image(s)</th> <th>Doll name</th> <th>Caption</th> </tr> <tr ng-repeat="cand in candidates" class="entry" ng-class="{\'not-an-entry\': storage[cand.storageKey].isIncluded === false}"> <td> <md-checkbox ng-model="storage[cand.storageKey].isIncluded" aria-label="Check to include in output"> </md-checkbox></td> <td> {{cand.postAuthor}} </td> <td ng-bind-html="cand.postBody.text | highlight:cand"></td> <td> <div ng-repeat="uri in cand.postBody.images"><img ng-src="{{uri}}"></div> </td> <td ng-class="{\'missing-info\': !storage[cand.storageKey].dollName}"> <md-input-container class="doll-name"> <label>Enter the name of the doll(s)</label> <input ng-disabled="!storage[cand.storageKey].isIncluded" type="text" ng-model="storage[cand.storageKey].dollName"> </md-input-container> </td> <td ng-class="{\'missing-info\': !storage[cand.storageKey].caption}"> <md-input-container> <label>Enter the caption</label> <input ng-disabled="!storage[cand.storageKey].isIncluded" type="text" ng-model="storage[cand.storageKey].caption"> <md-tooltip>{{storage[cand.storageKey].caption || \'unknown\'}}</md-tooltip> </md-input-container> </td> </tr> </table> </div> <div class="bb-code" ng-if="candidates"> <md-button ngclipboard data-clipboard-target="#all-bb-code">Copy to clipboard</md-button> <div> <textarea readonly id="all-bb-code" ng-value="getAllBbCode()">\r\n        </textarea> </div> </div>')}]);